<ResourceDictionary 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:SpectrumNet">

    <!-- =================== -->
    <!-- СТИЛИ СЛАЙДЕРОВ    -->
    <!-- =================== -->

    <!-- Шаблон для строки настроек со слайдером -->
    <ControlTemplate x:Key="SliderSettingRowTemplate">
        <Grid Margin="0,0,0,12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="40"/>
            </Grid.ColumnDefinitions>

            <TextBlock 
                Grid.Column="0"
                Text="{TemplateBinding Tag}"
                Foreground="{DynamicResource TextPrimaryBrush}"
                Margin="0,0,10,0"
                HorizontalAlignment="Right"
                VerticalAlignment="Center"/>

            <Slider 
                Grid.Column="1"
                Style="{DynamicResource ModernSliderStyle}"
                Height="20"
                Minimum="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Minimum}"
                Maximum="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Maximum}"
                Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Value, Mode=TwoWay}"
                VerticalAlignment="Center"/>

            <TextBlock 
                Grid.Column="2"
                Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Value, StringFormat='{}{0:F1}'}"
                Foreground="{DynamicResource TextPrimaryBrush}"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"/>
        </Grid>
    </ControlTemplate>

    <!-- Стиль современного слайдера -->
    <Style x:Key="ModernSliderStyle" TargetType="Slider" BasedOn="{StaticResource InteractiveControlBaseStyle}">
        <Setter Property="Height" Value="20"/>
        <Setter Property="Foreground" Value="{DynamicResource SliderForegroundBrush}"/>
        <Setter Property="Background" Value="{DynamicResource SliderBackgroundBrush}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource SliderBorderBrush}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
        <Setter Property="HorizontalAlignment" Value="Stretch"/>
        <Setter Property="TickPlacement" Value="BottomRight"/>
        <Setter Property="Margin" Value="0,4,0,4"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Slider">
                    <Grid>
                        <Border x:Name="TrackBackground"
                            Background="{TemplateBinding Background}"
                            Height="6" VerticalAlignment="Center"
                            CornerRadius="3"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="1">
                            <Border 
                                Height="3" VerticalAlignment="Top"
                                CornerRadius="2" Margin="0,0,0,0">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="#20FFFFFF" Offset="0"/>
                                        <GradientStop Color="#00FFFFFF" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                        </Border>

                        <TickBar x:Name="TopTick" 
                            Visibility="Collapsed"
                            Fill="{DynamicResource TextSecondaryBrush}"
                            Placement="Top"
                            Height="4" Margin="0,-10,0,0"
                            SnapsToDevicePixels="True"/>

                        <TickBar x:Name="BottomTick"
                            Visibility="Collapsed"
                            Fill="{DynamicResource TextSecondaryBrush}"
                            Placement="Bottom"
                            Height="4" Margin="0,0,0,-10"
                            SnapsToDevicePixels="True"/>

                        <Track Name="PART_Track"
                            Minimum="{TemplateBinding Minimum}"
                            Maximum="{TemplateBinding Maximum}"
                            Value="{TemplateBinding Value}"
                            IsDirectionReversed="False">
                            <Track.DecreaseRepeatButton>
                                <RepeatButton x:Name="DecreaseButton"
                                    Style="{x:Null}"
                                    Height="6" VerticalAlignment="Center"
                                    Focusable="False"
                                    Background="{TemplateBinding Foreground}">
                                    <RepeatButton.Template>
                                        <ControlTemplate TargetType="RepeatButton">
                                            <Border x:Name="DecreaseTrack"
                                                Background="{TemplateBinding Background}"
                                                CornerRadius="3"
                                                Height="6">
                                                <Border 
                                                    Height="3" VerticalAlignment="Top"
                                                    CornerRadius="2" Margin="0,0,0,0">
                                                    <Border.Background>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                            <GradientStop Color="#40FFFFFF" Offset="0"/>
                                                            <GradientStop Color="#00FFFFFF" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Border.Background>
                                                </Border>
                                            </Border>
                                        </ControlTemplate>
                                    </RepeatButton.Template>
                                </RepeatButton>
                            </Track.DecreaseRepeatButton>
                            <Track.IncreaseRepeatButton>
                                <RepeatButton x:Name="IncreaseButton"
                                    Style="{x:Null}"
                                    Height="6" VerticalAlignment="Center"
                                    Focusable="False"
                                    Background="Transparent">
                                    <RepeatButton.Template>
                                        <ControlTemplate TargetType="RepeatButton">
                                            <Border Background="Transparent" CornerRadius="3"/>
                                        </ControlTemplate>
                                    </RepeatButton.Template>
                                </RepeatButton>
                            </Track.IncreaseRepeatButton>
                            <Track.Thumb>
                                <Thumb x:Name="SliderThumb" 
                                    Width="16" Height="16" 
                                    Cursor="Hand" Focusable="False">
                                    <Thumb.Template>
                                        <ControlTemplate TargetType="Thumb">
                                            <Grid>
                                                <Ellipse x:Name="ThumbBackground"
                                                    Fill="{DynamicResource SliderForegroundBrush}" 
                                                    Width="16" Height="16"/>
                                                <Ellipse x:Name="ThumbHighlight"
                                                    Fill="White" Opacity="0.3"
                                                    Width="8" Height="8"/>
                                                <Ellipse x:Name="FocusRing"
                                                    Stroke="{DynamicResource FocusedBorderBrush}"
                                                    StrokeThickness="1"
                                                    Width="20" Height="20"
                                                    Opacity="0"/>
                                            </Grid>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="ThumbBackground" Property="Width" Value="18"/>
                                                    <Setter TargetName="ThumbBackground" Property="Height" Value="18"/>
                                                    <Setter TargetName="ThumbHighlight" Property="Width" Value="9"/>
                                                    <Setter TargetName="ThumbHighlight" Property="Height" Value="9"/>
                                                </Trigger>
                                                <Trigger Property="IsMouseCaptured" Value="True">
                                                    <Setter TargetName="ThumbBackground" Property="Width" Value="14"/>
                                                    <Setter TargetName="ThumbBackground" Property="Height" Value="14"/>
                                                    <Setter TargetName="ThumbHighlight" Property="Width" Value="7"/>
                                                    <Setter TargetName="ThumbHighlight" Property="Height" Value="7"/>
                                                </Trigger>
                                                <Trigger Property="IsFocused" Value="True">
                                                    <Setter TargetName="FocusRing" Property="Opacity" Value="1"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Thumb.Template>
                                </Thumb>
                            </Track.Thumb>
                        </Track>

                        <Popup x:Name="ValuePopup" 
                            PlacementTarget="{Binding ElementName=SliderThumb}"
                            Placement="Top"
                            AllowsTransparency="True"
                            PopupAnimation="Fade"
                            IsOpen="False">
                            <Border 
                                Background="{DynamicResource AccentBrush}"
                                CornerRadius="4"
                                Padding="6,2">
                                <TextBlock x:Name="ValueText"
                                    Text="{Binding Value, RelativeSource={RelativeSource TemplatedParent}, StringFormat='{}{0:F1}'}"
                                    Foreground="White"
                                    FontWeight="SemiBold" FontSize="12"
                                    HorizontalAlignment="Center"/>
                            </Border>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="TickPlacement" Value="TopLeft">
                            <Setter TargetName="TopTick" Property="Visibility" Value="Visible"/>
                        </Trigger>
                        <Trigger Property="TickPlacement" Value="BottomRight">
                            <Setter TargetName="BottomTick" Property="Visibility" Value="Visible"/>
                        </Trigger>
                        <Trigger Property="TickPlacement" Value="Both">
                            <Setter TargetName="TopTick" Property="Visibility" Value="Visible"/>
                            <Setter TargetName="BottomTick" Property="Visibility" Value="Visible"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="TrackBackground" Property="BorderBrush" Value="{DynamicResource ComboBoxHoverBorderBrush}"/>
                        </Trigger>
                        <EventTrigger RoutedEvent="Thumb.DragStarted" SourceName="SliderThumb">
                            <BeginStoryboard>
                                <Storyboard>
                                    <BooleanAnimationUsingKeyFrames 
                                        Storyboard.TargetName="ValuePopup"
                                        Storyboard.TargetProperty="IsOpen">
                                        <DiscreteBooleanKeyFrame KeyTime="0:0:0" Value="True"/>
                                    </BooleanAnimationUsingKeyFrames>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                        <EventTrigger RoutedEvent="Thumb.DragCompleted" SourceName="SliderThumb">
                            <BeginStoryboard>
                                <Storyboard>
                                    <BooleanAnimationUsingKeyFrames 
                                        Storyboard.TargetName="ValuePopup"
                                        Storyboard.TargetProperty="IsOpen">
                                        <DiscreteBooleanKeyFrame KeyTime="0:0:0.5" Value="False"/>
                                    </BooleanAnimationUsingKeyFrames>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="TrackBackground" Property="Opacity" Value="0.5"/>
                            <Setter TargetName="PART_Track" Property="Opacity" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Вертикальный слайдер -->
    <Style x:Key="VerticalSliderStyle" TargetType="Slider" BasedOn="{StaticResource ModernSliderStyle}">
        <Setter Property="Orientation" Value="Vertical"/>
        <Setter Property="Width" Value="20"/>
        <Setter Property="Height" Value="120"/>
    </Style>

    <!-- Слайдер с делениями -->
    <Style x:Key="TickedSliderStyle" TargetType="Slider" BasedOn="{StaticResource ModernSliderStyle}">
        <Setter Property="TickPlacement" Value="BottomRight"/>
        <Setter Property="TickFrequency" Value="10"/>
        <Setter Property="IsSnapToTickEnabled" Value="True"/>
    </Style>

</ResourceDictionary>