<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Thickness x:Key="SliderDecreaseOverlapMargin">0,0,-7,0</Thickness>
    <Thickness x:Key="SliderIncreaseOverlapMargin">-7,0,0,0</Thickness>

    <ControlTemplate x:Key="SliderThumbTemplate" TargetType="Thumb">
        <Grid Width="{TemplateBinding Width}" Height="{TemplateBinding Height}">
            <Border x:Name="Ring"
                    CornerRadius="999"
                    Background="Transparent"
                    BorderBrush="{DynamicResource SliderThumbBorderBrush}"
                    BorderThickness="1"
                    Opacity="0.45"/>

            <Border x:Name="Fill"
                    Margin="1"
                    CornerRadius="999"
                    Background="{DynamicResource SliderThumbFillBrush}"/>

            <Border x:Name="Dot"
                    Width="5"
                    Height="5"
                    CornerRadius="999"
                    Background="{DynamicResource SliderThumbAccentBrush}"
                    Opacity="0.95"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"/>
        </Grid>

        <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Ring" Property="Opacity" Value="0.9"/>
                <Setter TargetName="Ring" Property="BorderThickness" Value="1.5"/>
            </Trigger>

            <Trigger Property="IsMouseCaptured" Value="True">
                <Setter TargetName="Ring" Property="Opacity" Value="1"/>
                <Setter TargetName="Ring" Property="BorderThickness" Value="2"/>
                <Setter TargetName="Dot" Property="Opacity" Value="1"/>
            </Trigger>

            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.45"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate x:Key="DecreaseRepeatButtonTemplate" TargetType="RepeatButton">
        <Border Height="4"
                Margin="{StaticResource SliderDecreaseOverlapMargin}"
                CornerRadius="2,0,0,2"
                Background="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Slider}}"
                Opacity="0.95"/>
    </ControlTemplate>

    <ControlTemplate x:Key="IncreaseRepeatButtonTemplate" TargetType="RepeatButton">
        <Border Height="4"
                Margin="{StaticResource SliderIncreaseOverlapMargin}"
                CornerRadius="0,2,2,0"
                Background="{DynamicResource SliderBackgroundBrush}"
                BorderBrush="{DynamicResource SliderBorderBrush}"
                BorderThickness="1"
                Opacity="0.55"/>
    </ControlTemplate>

    <Style x:Key="ModernSliderStyle" TargetType="Slider" BasedOn="{StaticResource InteractiveControlBaseStyle}">
        <Setter Property="Foreground" Value="{DynamicResource SliderForegroundBrush}"/>
        <Setter Property="Background" Value="{DynamicResource SliderBackgroundBrush}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="TickPlacement" Value="None"/>
        <Setter Property="VerticalAlignment" Value="Center"/>

        <Setter Property="Height" Value="18"/>
        <Setter Property="MinHeight" Value="22"/>
        <Setter Property="Margin" Value="0,2"/>

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Slider">
                    <Grid x:Name="Root" SnapsToDevicePixels="True">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <Popup x:Name="ValuePopup"
                               Grid.Row="0"
                               AllowsTransparency="True"
                               PopupAnimation="None"
                               StaysOpen="True"
                               IsHitTestVisible="False"
                               Placement="Top"
                               PlacementTarget="{Binding ElementName=Thumb}"
                               VerticalOffset="-6"
                               HorizontalOffset="-18"
                               IsOpen="False">
                            <Grid SnapsToDevicePixels="True">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0"
                                        Background="{DynamicResource SurfaceBrush}"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="1"
                                        CornerRadius="7"
                                        Padding="8,3"
                                        MinWidth="46">
                                    <TextBlock Text="{Binding PlacementTarget.TemplatedParent.Value, RelativeSource={RelativeSource AncestorType=Popup}, StringFormat='{}{0:0.##}'}"
                                               Foreground="{DynamicResource TextPrimaryBrush}"
                                               FontSize="11"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"/>
                                </Border>

                                <Path Grid.Row="1"
                                      Data="M0,0 L10,0 L5,4 Z"
                                      Fill="{DynamicResource SurfaceBrush}"
                                      Stroke="{DynamicResource BorderBrush}"
                                      StrokeThickness="1"
                                      HorizontalAlignment="Center"
                                      Margin="0,-1,0,0"/>
                            </Grid>
                        </Popup>

                        <Grid Grid.Row="1" VerticalAlignment="Center" SnapsToDevicePixels="True">
                            <Border x:Name="TrackBase"
                                    Height="4"
                                    VerticalAlignment="Center"
                                    Background="{DynamicResource SliderBackgroundBrush}"
                                    BorderBrush="{DynamicResource SliderBorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="2"
                                    Opacity="0.65"/>

                            <Track x:Name="PART_Track"
                                   Minimum="{TemplateBinding Minimum}"
                                   Maximum="{TemplateBinding Maximum}"
                                   Value="{TemplateBinding Value}">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Command="{x:Static Slider.DecreaseLarge}"
                                                  Focusable="False"
                                                  Template="{StaticResource DecreaseRepeatButtonTemplate}"/>
                                </Track.DecreaseRepeatButton>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Command="{x:Static Slider.IncreaseLarge}"
                                                  Focusable="False"
                                                  Template="{StaticResource IncreaseRepeatButtonTemplate}"/>
                                </Track.IncreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb x:Name="Thumb"
                                           Width="14"
                                           Height="14"
                                           Cursor="Hand"
                                           Focusable="False"
                                           Template="{StaticResource SliderThumbTemplate}"/>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </Grid>

                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="ValuePopup" Property="IsOpen" Value="True"/>
                            <Setter TargetName="TrackBase" Property="Opacity" Value="0.9"/>
                        </Trigger>

                        <Trigger SourceName="Thumb" Property="IsMouseCaptured" Value="True">
                            <Setter TargetName="ValuePopup" Property="IsOpen" Value="True"/>
                            <Setter TargetName="TrackBase" Property="Opacity" Value="1"/>
                        </Trigger>

                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="Root" Property="Opacity" Value="0.45"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>
