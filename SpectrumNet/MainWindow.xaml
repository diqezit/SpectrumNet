<Window
    x:Class="SpectrumNet.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:sk="clr-namespace:SkiaSharp.Views.WPF;assembly=SkiaSharp.Views.WPF"
    xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
    Title="Spectrum Analyzer"
    Width="640" Height="480"
    MinWidth="640" MinHeight="480"
    WindowStartupLocation="CenterScreen"
    Background="Transparent"
    AllowsTransparency="True"
    WindowStyle="None"
    ResizeMode="CanResize">

    <shell:WindowChrome.WindowChrome>
        <shell:WindowChrome
            CaptionHeight="0"
            CornerRadius="0"
            GlassFrameThickness="0"
            ResizeBorderThickness="6"/>
    </shell:WindowChrome.WindowChrome>

    <Border
        Background="{DynamicResource WindowBackgroundBrush}"
        BorderBrush="{DynamicResource WindowBorderBrush}"
        BorderThickness="1"
        CornerRadius="{StaticResource CornerRadiusLarge}">

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="54"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Title Bar -->
            <Border
                Grid.Row="0"
                Style="{StaticResource TitleBarBorderStyle}"
                CornerRadius="12,12,0,0"
                MouseLeftButtonDown="OnDrag">
                <Grid Margin="16,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Theme Toggle - Left -->
                    <ToggleButton
                        x:Name="ThemeToggleButton"
                        Focusable="False"
                        Grid.Column="0"
                        Style="{StaticResource ThemeSwitchStyle}"
                        VerticalAlignment="Center"
                        ToolTip="Toggle theme (light/dark)"/>

                    <!-- Title - Center -->
                    <Grid Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <ContentControl
                                Content="Spectrum Analyzer"
                                Style="{StaticResource SpectrumAnalyserTitleStyle}"
                                VerticalAlignment="Center"/>

                            <TextBlock
                                FontSize="14"
                                Cursor="Hand"
                                Margin="8,0,0,0"
                                VerticalAlignment="Center"
                                Foreground="{DynamicResource TextSecondaryBrush}"
                                ToolTipService.ShowDuration="30000">
                                <Hyperlink
                                    NavigateUri="https://github.com/diqezit/SpectrumNet"
                                    RequestNavigate="Hyperlink_RequestNavigate">
                                    <TextBlock Text="ⓘ" FontSize="16"/>
                                    <Hyperlink.Style>
                                        <Style TargetType="Hyperlink">
                                            <Setter Property="TextDecorations" Value="{x:Null}"/>
                                            <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Hyperlink.Style>
                                </Hyperlink>
                                <TextBlock.ToolTip>
                                    <ToolTip Style="{StaticResource ToolTipStyle}">
                                        <StackPanel>
                                            <TextBlock Text="Authors:" FontWeight="SemiBold" Margin="0,0,0,4"/>
                                            <TextBlock Text="• Diqezit — Lead Developer" Margin="0,2"/>
                                            <TextBlock Text="• haker2550 — Lead Tester" Margin="0,2"/>
                                            <Separator Margin="0,6" Background="{DynamicResource BorderBrush}"/>
                                            <TextBlock Text="github.com/diqezit/SpectrumNet" 
                                                       Foreground="{DynamicResource AccentBrush}"/>
                                        </StackPanel>
                                    </ToolTip>
                                </TextBlock.ToolTip>
                            </TextBlock>
                        </StackPanel>
                    </Grid>

                    <!-- Window Controls - Right -->
                    <StackPanel
                        Grid.Column="2"
                        Orientation="Horizontal"
                        VerticalAlignment="Center">

                        <Button
                            x:Name="OpenControlPanelButton"
                            Focusable="False"
                            Style="{StaticResource WindowControlButtonStyle}"
                            Margin="0,0,4,0"
                            ToolTip="Open control panel"
                            Click="OnButtonClick">
                            <Viewbox Width="18" Height="18" Stretch="Uniform">
                                <Path
                                    Stroke="White"
                                    StrokeThickness="1.8"
                                    StrokeLineJoin="Round"
                                    StrokeStartLineCap="Round"
                                    StrokeEndLineCap="Round"
                                    Fill="Transparent"
                                    Data="M9.5,3 A6.5,6.5 0 1 1 9.5,16 A6.5,6.5 0 0 1 9.5,3
                                          M9.5,6 A3.5,3.5 0 1 0 9.5,13 A3.5,3.5 0 0 0 9.5,6
                                          M9.5,0 L9.5,2 M9.5,17 L9.5,19
                                          M0,9.5 L2,9.5 M17,9.5 L19,9.5
                                          M2.8,2.8 L4.2,4.2 M14.8,14.8 L16.2,16.2
                                          M2.8,16.2 L4.2,14.8 M14.8,4.2 L16.2,2.8"/>
                            </Viewbox>
                        </Button>

                        <Button
                            x:Name="MinimizeButton"
                            Style="{StaticResource WindowControlButtonStyle}"
                            ToolTip="Minimize"
                            Click="OnButtonClick">
                            <Path
                                Data="M4,10 H16"
                                Stroke="White"
                                StrokeThickness="2"
                                StrokeStartLineCap="Round"
                                StrokeEndLineCap="Round"/>
                        </Button>

                        <Button
                            x:Name="MaximizeButton"
                            Style="{StaticResource WindowControlButtonStyle}"
                            ToolTip="Maximize/Restore"
                            Click="OnButtonClick">
                            <Path
                                x:Name="MaximizeIcon"
                                Data="M4,4 H16 V16 H4 Z"
                                Stroke="White"
                                StrokeThickness="2"
                                StrokeLineJoin="Round"
                                StrokeStartLineCap="Square"
                                StrokeEndLineCap="Square"
                                Fill="Transparent"/>
                        </Button>

                        <Button
                            x:Name="CloseButton"
                            Style="{StaticResource WindowCloseButtonStyle}"
                            ToolTip="Close"
                            Click="OnButtonClick">
                            <Path
                                Data="M4,4 L16,16 M16,4 L4,16"
                                Stroke="White"
                                StrokeThickness="2"
                                StrokeStartLineCap="Round"
                                StrokeEndLineCap="Round"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Main Content -->
            <Border
                Grid.Row="1"
                Background="{DynamicResource SurfaceBrush}"
                CornerRadius="0,0,12,12"
                Margin="12,0,12,12">

                <Border
                    Background="{DynamicResource BackgroundBrush}"
                    CornerRadius="8"
                    Margin="8">

                    <sk:SKElement
                        x:Name="spectrumCanvas"
                        Margin="8"
                        PaintSurface="OnPaintSurface"/>
                </Border>
            </Border>
        </Grid>
    </Border>
</Window>
